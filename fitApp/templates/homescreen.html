<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
  <meta charset="UTF-8">
  <title>Sports Performance Analysis</title>
  {{sport}}
  {{technique}}
  <link rel="stylesheet" href="{% static 'css/homescreen.css' %}" type="text/css">
  
</head>
<body>
  <div class="container">
    <h1 class="title">Upload Performance Images</h1>
    <p class="subtitle">Compare your form with a professional athlete's image for personalized analysis.</p>

    <form id="image-upload-form" method="POST" enctype="multipart/form-data" action="{% url 'analyzing' %}">
      {% csrf_token %}
      <div class="upload-section">
        <div class="upload-box">
          <h2>Your Image</h2>
          <input type="file" name="user_image" id="userImage" accept="image/*" required>
          <div class="preview-wrapper">
            <img id="previewUser" class="image-preview" alt="User Preview" style="display: none;" />
          </div>
        </div>

        <div class="upload-box">
          <h2>Professional Athlete's Image</h2>
          <input type="file" name="athlete_image" id="athleteImage" accept="image/*" required>
          <div class="preview-wrapper">
            <img id="previewAthlete" class="image-preview" alt="Athlete Preview" style="display: none;" />
          </div>
        </div>
      </div>

      <button type="submit" class="analyze-button">Start Analysis</button>
    </form>
  </div>
  <div class="loading-overlay" id="loadingOverlay" style="display: none;">
    <p>Loading...</p>
  </div>
  <script>
    const userImageInput = document.getElementById('userImage');
    const athleteImageInput = document.getElementById('athleteImage');
    const previewUser = document.getElementById('previewUser');
    const previewAthlete = document.getElementById('previewAthlete');
    const form = document.getElementById('image-upload-form');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const container = document.getElementById('container');

    // Image preview functionality
    userImageInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        previewUser.src = URL.createObjectURL(file);
        previewUser.style.display = 'inline-block';
      }
    });

    athleteImageInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        previewAthlete.src = URL.createObjectURL(file);
        previewAthlete.style.display = 'inline-block';
      }
    });
    form.addEventListener('submit', (e) => {
     loadingOverlay.style.display = 'flex';
     container.style.display = 'none';

     setTimeout(() => {form.submit(); }, 100);

    // Prevent the default immediate form submission
    e.preventDefault();
  });
  </script>
  </script>
</body>
</html>
